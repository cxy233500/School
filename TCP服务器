#include<stdio.h>
#include<windows.h>
#include<winsock.h>
#include<stdlib.h>
#pragma comment (lib,"ws2_32.lib")
int main()
{
	//初始化套接字
	WSADATA data;
	WORD x = MAKEWORD(2, 0);
	WSAStartup(x, &data);

	//创建套接字
	SOCKET s1, s2;
	s1 = socket(AF_INET, SOCK_STREAM, 0);
	//地址和端口的处理
	sockaddr_in addr1, addr2;
	int size = sizeof(addr2);
	addr1.sin_family = AF_INET;
	addr1.sin_addr.S_un.S_addr = htonl(INADDR_ANY);
	addr1.sin_port = htons(75);
	
	//套接字绑定本地地址和端口
	bind(s1,(sockaddr*)&addr1,sizeof(addr1));
	//监听
	listen(s1, 5);
	s2 = accept(s1, (sockaddr*)&addr2, &size);
	printf("服务器已启动:\n");
	char str1[100];
	char str2[100];
	while (1)
	{
		//接收数据
		recv(s2, str2, sizeof(str2), 0);
		printf("client say:%s\n", str2);
		//发送数据
		printf("server enter message:");
		scanf_s("%s", str1, 100);
		send(s2, str1, sizeof(str1), 0);
	}
	closesocket(s1);
	closesocket(s2);
	WSACleanup();
	system("pause");
	return 0;
}
